!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("axios"),require("stream")):"function"==typeof define&&define.amd?define(["axios","stream"],t):"object"==typeof exports?exports.FairOS=t(require("axios"),require("stream")):e.FairOS=t(e.axios,e.stream)}(this,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){e.exports=n(3)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var o=n(0),r=n.n(o);const i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";var a=function(e){let t="";for(;e--;)t+=i[Math.random()*i.length<<0];return t};var s=e=>String(e).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22");var u=e=>"function"==typeof e;var c=e=>Boolean(e&&u(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&u(e.append)&&u(e.getAll)&&u(e.entries)&&u(e[Symbol.iterator]));const l=["File","Blob"];var d,f,h,p,v,y,m,k,b,g=e=>Boolean(e&&"object"==typeof e&&u(e.constructor)&&l.includes(e[Symbol.toStringTag])&&u(e.stream)&&null!=e.name&&null!=e.size&&null!=e.lastModified),_=function(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n},w=function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};class O{constructor(e,t=a(16)){if(d.add(this),f.set(this,void 0),h.set(this,void 0),p.set(this,void 0),v.set(this,"-".repeat(2)),y.set(this,void 0),m.set(this,void 0),k.set(this,void 0),!c(e))throw new TypeError("Expected first argument to be a FormData instance.");if("string"!=typeof t)throw new TypeError("Expected boundary to be a string.");this.boundary="form-data-boundary-"+t,this.contentType="multipart/form-data; boundary="+this.boundary,_(this,y,new TextEncoder,"f"),_(this,f,"\r\n","f"),_(this,h,w(this,y,"f").encode(w(this,f,"f")),"f"),_(this,p,w(this,h,"f").byteLength,"f"),_(this,k,e,"f"),_(this,m,w(this,y,"f").encode(`${w(this,v,"f")}${this.boundary}${w(this,v,"f")}${w(this,f,"f").repeat(2)}`),"f"),this.headers=Object.freeze({"Content-Type":this.contentType,"Content-Length":this.getContentLength()})}getContentLength(){let e=0;for(const[t,n]of w(this,k,"f"))e+=w(this,d,"m",b).call(this,t,n).byteLength,e+=g(n)?n.size:w(this,y,"f").encode(String(n)).byteLength,e+=w(this,p,"f");return e+w(this,m,"f").byteLength}*values(){for(const[e,t]of w(this,k,"f").entries())yield w(this,d,"m",b).call(this,e,t),yield g(t)?t:w(this,y,"f").encode(String(t)),yield w(this,h,"f");yield w(this,m,"f")}async*encode(){for(const e of this.values())g(e)?yield*e.stream():yield e}[(f=new WeakMap,h=new WeakMap,p=new WeakMap,v=new WeakMap,y=new WeakMap,m=new WeakMap,k=new WeakMap,d=new WeakSet,b=function(e,t){let n="";return n+=`${w(this,v,"f")}${this.boundary}${w(this,f,"f")}`,n+=`Content-Disposition: form-data; name="${s(e)}"`,g(t)&&(n+=`; filename="${s(t.name)}"${w(this,f,"f")}`,n+="Content-Type: "+(t.type||"application/octet-stream")),w(this,y,"f").encode(`${n}${w(this,f,"f").repeat(2)}`)},Symbol.iterator)](){return this.values()}[Symbol.asyncIterator](){return this.encode()}}var j=n(1);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://localhost:9090/v1/",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];E(this,e),x(this,"isNode","undefined"==typeof window),x(this,"baseURL",void 0),x(this,"cookie",""),x(this,"isStoreNodeCookie",void 0),this.baseURL=t,this.isStoreNodeCookie=n}var t,n,o;return t=e,(n=[{key:"setNodeCookie",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.cookie=e}},{key:"setIsStoreNewCookie",value:function(e){this.isStoreNodeCookie=e}},{key:"handleCookies",value:function(e){if(this.isNode&&this.isStoreNodeCookie){var t=e.headers["set-cookie"];t&&t.length&&(t=t[0].split(";"))&&t.length&&(this.cookie=t[0])}return e}},{key:"getCookieObject",value:function(){return this.isNode?{Cookie:this.cookie}:{}}},{key:"get",value:function(e){var t=this;return r()({baseURL:this.baseURL,url:e,method:"GET",headers:S({"Content-Type":"application/json"},this.getCookieObject()),withCredentials:!0}).then((function(e){return t.handleCookies(e)}))}},{key:"post",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r()({baseURL:this.baseURL,url:e,method:"POST",data:n,headers:S({"Content-Type":"application/json"},this.getCookieObject()),withCredentials:!0}).then((function(e){return t.handleCookies(e)}))}},{key:"download",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return r()({responseType:"arraybuffer",baseURL:this.baseURL,url:e,method:"POST",data:n,headers:S({},this.getCookieObject()),withCredentials:!0,onDownloadProgress:o}).then((function(e){return t.handleCookies(e)}))}},{key:"delete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r()({baseURL:this.baseURL,url:e,method:"DELETE",data:n,headers:S({"Content-Type":"application/json"},this.getCookieObject()),withCredentials:!0}).then((function(e){return t.handleCookies(e)}))}},{key:"upload",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new O(t);return r()({baseURL:this.baseURL,url:e,method:"POST",data:this.isNode?j.Readable.from(i.encode()):t,headers:S(S({},this.getCookieObject()),this.isNode?i.headers:{}),withCredentials:!0,onUploadProgress:o}).then((function(e){return n.handleCookies(e)}))}},{key:"userLogin",value:function(e,t){return this.post("user/login",{user_name:e,password:t})}},{key:"userSignup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.post("user/signup",{user_name:e,password:t,mnemonic:n})}},{key:"userImport",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(n&&o||!n&&!o)throw Error("Pass only mnemonic or only address");return this.post("user/import",{user_name:e,password:t,mnemonic:n,address:o})}},{key:"userPresent",value:function(e){return this.get("user/present?user_name=".concat(e))}},{key:"userIsLoggedIn",value:function(e){return this.get("user/isloggedin?user_name=".concat(e))}},{key:"userLogout",value:function(){return this.post("user/logout")}},{key:"userExport",value:function(){return this.post("user/export")}},{key:"userStat",value:function(){return this.get("user/stat")}},{key:"userDelete",value:function(e){return this.delete("user/delete",{password:e})}},{key:"podNew",value:function(e,t){return this.post("pod/new",{pod_name:e,password:t})}},{key:"podOpen",value:function(e,t){return this.post("pod/open",{pod_name:e,password:t})}},{key:"podSync",value:function(e){return this.post("pod/sync",{pod_name:e})}},{key:"podClose",value:function(e){return this.post("pod/close",{pod_name:e})}},{key:"podDelete",value:function(e){return this.delete("pod/delete",{pod_name:e})}},{key:"podLs",value:function(){return this.get("pod/ls")}},{key:"podStat",value:function(e){return this.get("pod/stat?pod_name=".concat(e))}},{key:"podShare",value:function(e,t){return this.post("pod/share",{pod_name:e,password:t})}},{key:"podReceiveInfo",value:function(e){return this.get("pod/receiveinfo?sharing_ref=".concat(e))}},{key:"podReceive",value:function(e){return this.get("pod/receive?sharing_ref=".concat(e))}},{key:"dirMkdir",value:function(e,t){return this.post("dir/mkdir",{dir_path:t,pod_name:e})}},{key:"dirRmdir",value:function(e,t){return this.delete("dir/rmdir",{dir_path:t,pod_name:e})}},{key:"dirLs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return this.get("dir/ls?pod_name=".concat(e,"&dir_path=").concat(t))}},{key:"dirStat",value:function(e,t,n){return this.get("dir/stat?dir=".concat(t,"&pod_name=").concat(e,"&dir_path=").concat(n))}},{key:"fileUpload",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"1Mb",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!n.has("files"))throw new Error('Field "files" is not defined');return n.set("pod_name",e),n.set("block_size",o),n.set("dir_path",t),this.upload("file/upload",n,r)}},{key:"fileDownload",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.download("file/download?file_path=".concat(t,"&file=").concat(n,"&pod_name=").concat(e),{},o)}},{key:"fileStat",value:function(e,t){return this.get("file/stat?pod_name=".concat(e,"&file_path=").concat(t))}},{key:"fileShare",value:function(e,t,n){return this.post("file/share",{pod_name:e,file_path:t,dest_user:n})}},{key:"fileReceiveInfo",value:function(e,t){return this.get("file/receiveinfo?pod_name=".concat(e,"&sharing_ref=").concat(t))}},{key:"fileReceive",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return this.get("file/receive?pod_name=".concat(e,"&sharing_ref=").concat(t,"&dir_path=").concat(n))}},{key:"fileDelete",value:function(e,t){return this.delete("file/delete",{pod_name:e,file_path:t})}},{key:"kvNew",value:function(e,t){return this.post("kv/new",{pod_name:e,table_name:t})}},{key:"kvOpen",value:function(e,t){return this.post("kv/open",{pod_name:e,table_name:t})}},{key:"kvCount",value:function(e,t){return this.post("kv/count",{pod_name:e,table_name:t})}},{key:"kvLs",value:function(e){return this.get("kv/ls?pod_name=".concat(e))}},{key:"kvDelete",value:function(e,t){return this.delete("kv/delete",{pod_name:e,table_name:t})}},{key:"kvEntryPut",value:function(e,t,n,o){return this.post("kv/entry/put",{pod_name:e,table_name:t,key:n,value:o})}},{key:"kvEntryGet",value:function(e,t,n){return this.get("kv/entry/get?pod_name=".concat(e,"&table_name=").concat(t,"&key=").concat(n))}},{key:"kvEntryDelete",value:function(e,t,n){return this.delete("kv/entry/del",{pod_name:e,table_name:t,key:n})}},{key:"kvLoadCsv",value:function(e,t,n){if(!n.has("csv"))throw new Error('Field "csv" is not defined');return n.set("pod_name",e),n.set("table_name",t),this.upload("kv/loadcsv",n)}},{key:"kvSeek",value:function(e,t,n,o,r){return this.post("kv/seek",{pod_name:e,table_name:t,start_prefix:n,end_prefix:o,limit:r})}},{key:"kvSeekNext",value:function(e,t){return this.get("kv/seek/next?pod_name=".concat(e,"&table_name=").concat(t))}},{key:"docNew",value:function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.post("doc/new",{pod_name:e,table_name:t,si:n,mutable:o.toString()})}},{key:"docOpen",value:function(e,t){return this.post("doc/open",{pod_name:e,table_name:t})}},{key:"docCount",value:function(e,t){return this.post("doc/count",{pod_name:e,table_name:t})}},{key:"docFind",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return this.get("doc/find?pod_name=".concat(e,"&table_name=").concat(t,"&expr=").concat(n,"&limit=").concat(o))}},{key:"docLs",value:function(e){return this.get("doc/ls?pod_name=".concat(e))}},{key:"docDelete",value:function(e,t){return this.delete("doc/delete",{pod_name:e,table_name:t})}},{key:"docEntryPut",value:function(e,t,n){return this.post("doc/entry/put",{pod_name:e,table_name:t,doc:n})}},{key:"docEntryGet",value:function(e,t,n){return this.get("doc/entry/get?pod_name=".concat(e,"&table_name=").concat(t,"&id=").concat(n))}},{key:"docEntryDelete",value:function(e,t,n){return this.delete("doc/entry/del",{pod_name:e,table_name:t,id:n})}},{key:"docLoadJson",value:function(e,t,n){if(!n.has("json"))throw new Error('Field "json" is not defined');return n.set("pod_name",e),n.set("table_name",t),this.upload("doc/loadjson",n)}},{key:"docIndexJson",value:function(e,t,n){if(!n.has("json"))throw new Error('Field "json" is not defined');return n.set("pod_name",e),n.set("table_name",t),this.upload("doc/indexjson",n)}},{key:"test",value:function(){return"FairOS test OK"}}])&&L(t.prototype,n),o&&L(t,o),e}()}]).default}));